{"version":3,"file":"index.js","sources":["../src/componentInLibraries.js","../src/fieldArray.js","../src/field.js","../src/content.js","../src/cache.js","../src/index.js"],"sourcesContent":["export default (props) => {\n  const { componentsLibraries = [() => null], item } = props\n\n  for (var i = 0; i < componentsLibraries.length; i++) {\n    const library = componentsLibraries[i]\n    if (!library) {\n      continue\n    }\n    if (typeof library !== 'function') {\n      console.log('is not function', library)\n      continue\n    }\n    const component = library(item)\n    if (component) {\n      return component\n    }\n  }\n\n  return null\n}\n","import React, { useState, useRef } from 'react'\nimport { Field, ErrorMessage as BaseErrorMesssage, FieldArray, getIn } from 'formik'\nimport componentInLibraries from './componentInLibraries'\n\nexport default (props) => {\n  const {\n    item: { type, id, label, forceLabel = false, className = \"\", },\n    hideErrors,\n  } = props\n\n  return <div className={`form-control mb-4 ${className}`}>\n    {\n      (label && forceLabel) &&\n      <label className=\"label\">\n        <span>{label}</span>\n      </label>\n    }\n    <FieldArray\n      type={type}\n      name={id}\n      //validateOnChange\n      component={(arrayHelpers) => render({ ...props, arrayHelpers })} />\n    {/* <FieldArray\n      type={type}\n      name={id}\n      render={(arrayHelpers) => render({ ...props, arrayHelpers })} /> */}\n    {/* <FieldArray\n      type={type}\n      name={id}>\n      {(arrayHelpers) => render({ ...props, arrayHelpers })}\n    </FieldArray> */}\n    {!hideErrors ?\n      <ErrorMessage\n        name={id}\n        component=\"div\"\n        className=\"text-sm text-red-600 pt-2\" /> : null}\n  </div>\n}\n\n\nconst ErrorMessage = ({ name }) => (\n  <Field\n    name={name}\n    render={({ form }) => {\n      const error = getIn(form.errors, name)\n      const touch = getIn(form.touched, name)\n      return touch && error ? error : null\n    }}\n  />\n)\n\nconst render = (props) => {\n  const {\n    values,\n    item: {\n      id,\n      className = \"\",\n      params,\n      container,\n      add\n    },\n\n    hideErrors } = props\n\n  const items = values[id] ? values[id] : []\n  //const [counter, setCounter] = useState(1)\n  const _cachedValues = useRef(props.values)\n  const Component = componentInLibraries({ componentsLibraries: props.componentsLibraries, item: params })\n  if (!Component) {\n    return null\n  }\n\n  const { arrayHelpers } = props\n  const { move, swap, push, insert, unshift, pop, remove, form } = arrayHelpers\n\n  const onAdd = () => {\n    onLayoutWillChange()\n    push(params.params.placeholder())\n  }\n\n  const onLayoutWillChange = () => {\n    //const { item: { id }, setFieldValue, setFieldTouched, setValues } = props\n    //setValues(_cachedValues.current)\n  }\n\n  const onValueChanged = (value) => {\n    const { item: { id }, setFieldValue, setFieldTouched, setValues } = props\n\n    const _values = { ...props.values }\n    _values[id] = value\n    _cachedValues.current = { ..._values }\n    props._onValueChanged && props._onValueChanged({ id, value })\n    //setValues(_values)\n    //TODO:\n    // setFieldValue(id, value, true)\n    // setFieldTouched(id, true, false)\n  }\n\n  var ContainerComponent = componentInLibraries({\n    componentsLibraries: props.componentsLibraries,\n    item: container\n  })\n\n  if (!ContainerComponent) {\n    ContainerComponent = ({ children }) => <div>{children}</div>\n  }\n\n  var AddComponent = componentInLibraries({\n    componentsLibraries: props.componentsLibraries,\n    item: add\n  })\n\n  if (!AddComponent) {\n    AddComponent = ({ onClick, title, disabled }) => <div className={`flex justify-center my-10`}><button disabled={disabled}\n      type=\"button\"\n      onClick={onClick}>\n      {title ? title : \"Add\"}\n    </button>\n    </div>\n  }\n\n  return <div>\n    <div className={`w-full overflow-x-scroll ${props.item.isHorizontal ? 'flex gap-2 pb-8' : ''}`}>\n      {(items && items.length > 0) && items.map((entry, index) => {\n        const itemId = `${id}.${index}`\n        return <div key={index} className={`form-control ${!props.item.isHorizontal ? 'mb-4' : ''}  ${className}`}>\n          {/* {\n        (label && forceLabel) &&\n        <label className=\"label\">\n          <span>{label}</span>\n        </label>\n      } */}\n\n          <Field type={params.type} name={itemId} >\n            {({ field, form }) => {\n              const onRemoveRequired = () => {\n                remove(index)\n                const _i = [...items]\n                _i.splice(index, 1)\n                onValueChanged(_i)\n                //setCounter(counter + 1)\n              }\n\n              const onMoveDownRequired = () => {\n                if (items.length <= index) {\n                  return\n                }\n                swap(index, index + 1)\n\n                const _i = [...items]\n                const object = _i[index]\n                const other = _i[index + 1]\n                _i[index] = other\n                _i[index + 1] = object\n                onValueChanged(_i)\n                //setCounter(counter + 1)\n              }\n\n              const onMoveUpRequired = () => {\n                if (index === 0) {\n                  return\n                }\n                swap(index, index - 1)\n\n                const _i = [...items]\n                const object = _i[index]\n                const other = _i[index - 1]\n                _i[index] = other\n                _i[index - 1] = object\n                onValueChanged(_i)\n                //setCounter(counter + 1)\n              }\n\n              const onEntryValuesChanged = (value) => {\n                const _i = [...items]\n                _i[index] = value\n                onValueChanged(_i)\n              }\n\n              const disabled = props.isSubmitting || props.disabled || (props.item && props.item.disabled)\n              const readOnly = props.readOnly || (props.props && props.props.readOnly)\n\n              return <ContainerComponent\n                {...container}\n                // {...props}\n                arrayHelpers={arrayHelpers}\n                onMoveDownRequired={onMoveDownRequired}\n                onMoveUpRequired={onMoveUpRequired}\n                onRemoveRequired={onRemoveRequired}\n                canMoveUp={props.item.canMove && (index > 0)}\n                canMoveDown={props.item.canMove && (index < (items.length - 1))}\n                canRemove={props.item.canRemove}\n                showControls={props.item.showControls}\n                index={index}\n                value={entry}>\n                <Component\n                  {...props}\n                  disabled={disabled}\n                  readOnly={readOnly}\n                  value={entry}\n                  {...params.params}\n                  onValueChanged={onEntryValuesChanged} />\n              </ContainerComponent>\n            }}\n          </Field>\n          {!hideErrors ?\n            <BaseErrorMesssage\n              name={itemId}\n              component=\"div\"\n              className=\"text-sm text-red-600 pt-2\" />\n            : null}\n        </div>\n      })}\n    </div>\n    {(!props.disabled && props.item.canAddItems && items.length < props.item.maxItems) &&\n      <AddComponent onClick={onAdd} title={add.title} disabled={items.length >= props.item.maxItems} />\n    }\n  </div>\n}\n","import React from 'react'\nimport { Field, ErrorMessage, FastField } from 'formik'\nimport componentInLibraries from './componentInLibraries'\nimport { nanoid } from 'nanoid'\n\nexport default (props) => {\n  const { item: { type, id, label, isDependant = false, forceLabel = false, className = \"\" },\n    onValueChanged, hideErrors } = props\n  const Component = componentInLibraries({ componentsLibraries: props.componentsLibraries, item: props.item })\n  if (!Component) {\n    return null\n  }\n\n  const _id = id ? id : nanoid()\n  const Renderer = isDependant ? Field : FastField\n  const _props = { ...props }\n  return <div className={`mb-8 ${className}`}>\n    {\n      (label && forceLabel) &&\n      <label className=\"label\">\n        <span>{label}</span>\n      </label>\n    }\n\n    <Renderer type={type} name={_id} >\n      {({ field, form }) => {\n\n        const onValueChanged = (value) => {\n          console.log('onValueChanged', value)\n          if (!props.item.id) {\n            return\n          }\n          const { item: { id }, setFieldValue, setFieldTouched } = props\n\n          props._onValueChanged && props._onValueChanged({ id, value })\n\n          setFieldValue(id, value, true)\n          setFieldTouched(id, true, false)\n        }\n\n        const disabled = props.isSubmitting || props.disabled || (props.item && props.item.disabled)\n        const readOnly = props.readOnly || (props.props && props.props.readOnly)\n        return <div>\n          <Component\n            {...props}\n            disabled={disabled}\n            readOnly={readOnly}\n            value={props.values[id]}\n            error={props.errors[id]}\n            field={field}\n            form={form}\n            onValueChanged={onValueChanged} />\n          {(!hideErrors && id)\n            ? <div className=\"\n            my-2\n            mb-4\n            px-2\n            rounded-b-lg\">\n              <ErrorMessage\n                name={_id}\n                component=\"div\"\n                className=\"text-sm text-red-500 \" />\n            </div>\n            : null}\n        </div>\n      }}\n    </Renderer>\n  </div>\n}\n","import React from 'react'\nimport { Form } from 'formik'\nimport FieldArray from './fieldArray'\nimport Field from './field'\n\nexport const generate = (props) => {\n  const { inputs } = props\n  const items = Array.isArray(inputs) ? inputs : inputs()\n  return <Form>\n    {\n      items.map(item => {\n        const { isMulti } = item\n        if (isMulti) {\n          return _generateItemsView({ ...props, item })\n        }\n\n        return _generateItemView({ ...props, item, })\n      })\n    }\n  </Form>\n}\n\nconst _generateItemsView = (props) => {\n  const { item: { className, items } } = props\n  return <div className={className}>\n    {items.map(_item => _generateItemView({ ...props, item: _item, }))}\n  </div>\n}\n\nconst _generateItemView = (props) => {\n  const { item } = props\n  if (item.hide) {\n    return null\n  }\n\n  if (item.isList) {\n    return <FieldArray {...props} />\n  }\n\n  return <Field {...props} />\n}\n","export default class FormulaikCache {\n  _data = {}\n  constructor(props) {\n\n  }\n\n  get data() { return this._data }\n  set data(value) { this._data = value }\n\n  add = ({ search, results, key }) => {\n    const _key = key.toLowerCase()\n    if (!this.data[_key]) {\n      this.data[_key] = {}\n    }\n    this.data[_key][search] = [...results]\n    //console.log('Formulaik cache > add >', _key, search, results)\n  }\n\n  get = ({ search, key }) => {\n    const _key = key.toLowerCase()\n    if (!this.data[_key]) {\n      //console.log('Formulaik cache > get > key is not present', _key)\n      return null\n    }\n\n    //console.log('Formulaik cache > get > key is present', _key, 'Returning', this.data[_key][search])\n    return this.data[_key][search]\n  }\n\n  clear = () => {\n    this.data = {}\n  }\n}\n","import React, { useRef, } from 'react'\nimport { Formik } from 'formik'\nimport { generate } from './content'\nimport FormulaikCache from './cache'\n\nexport default (props) => {\n  const {\n    onSubmit,\n    error,\n    onFormPropsChanged,\n    disableCache = false,\n    hideErrors = false,\n    disabled = false,\n    readOnly = false\n  } = props\n\n  const initialValues = (typeof props.initialValues !== 'function') ? props.initialValues : (props.initialValues && props.initialValues())\n  const validationSchema = (typeof props.validationSchema !== 'function') ? props.validationSchema : (props.validationSchema && props.validationSchema())\n\n  const changedValues = useRef(initialValues)\n  const cache = disableCache ? null : (props.cache ? props.cache : useRef(new FormulaikCache()).current)\n  const onValuesChanged = (values) => {\n    changedValues.current = values\n    props.onValuesChanged && props.onValuesChanged(values)\n    console.log('onValuesChanged hook')\n  }\n\n  const _onValueChanged = ({ id, value }) => {\n    const values = {\n      ...changedValues.current,\n    }\n    values[id] = value\n    onValuesChanged(values)\n  }\n\n  return <div className=''>\n    <Formik\n      initialValues={initialValues}\n      validationSchema={validationSchema}\n      validateOnBlur\n      validateOnChange\n      onSubmit={onSubmit}>\n      {formProps => {\n        onFormPropsChanged && onFormPropsChanged(formProps)\n        return generate({ ...formProps, ...props, initialValues, validationSchema, onValuesChanged, _onValueChanged, cache, disableCache, disabled, readOnly, hideErrors })\n      }}\n    </Formik>\n    {error &&\n      <div className=\"alert alert-error mb-4\">\n        <div className=\"flex-1\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" className=\"w-6 h-6 mx-2 stroke-current\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636\"></path>\n          </svg>\n          <label>{error.message}</label>\n        </div>\n      </div>}\n  </div>\n}\n"],"names":["props","componentsLibraries","item","i","length","library","console","log","component","type","id","label","forceLabel","className","hideErrors","React","FieldArray","arrayHelpers","render","ErrorMessage","name","Field","form","error","getIn","errors","touch","touched","values","params","container","add","items","_cachedValues","useRef","Component","componentInLibraries","swap","push","insert","remove","onAdd","onLayoutWillChange","placeholder","onValueChanged","value","_values","current","_onValueChanged","ContainerComponent","children","AddComponent","onClick","title","disabled","isHorizontal","map","entry","index","itemId","onRemoveRequired","_i","splice","onMoveDownRequired","object","other","onMoveUpRequired","onEntryValuesChanged","isSubmitting","readOnly","canMove","canRemove","showControls","BaseErrorMesssage","canAddItems","maxItems","isDependant","_id","nanoid","Renderer","FastField","_props","field","setFieldValue","setFieldTouched","generate","inputs","Array","isArray","Form","isMulti","_generateItemsView","_generateItemView","_item","hide","isList","FormulaikCache","_data","search","results","key","_key","toLowerCase","data","get","clear","onSubmit","onFormPropsChanged","disableCache","initialValues","validationSchema","changedValues","cache","onValuesChanged","Formik","formProps","message"],"mappings":"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"}