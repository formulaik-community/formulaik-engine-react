{"version":3,"file":"index.modern.js","sources":["../src/componentInLibraries.js","../src/fieldArray.js","../src/field.js","../src/content.js","../src/cache.js","../src/index.js"],"sourcesContent":["export default (props) => {\n  const { componentsLibraries = [() => null], item } = props\n\n  for (var i = 0; i < componentsLibraries.length; i++) {\n    const component = componentsLibraries[i](item)\n    if (component) {\n      return component\n    }\n  }\n\n  return null\n}\n","import React, { useState } from 'react'\nimport { Field, ErrorMessage as BaseErrorMesssage, FieldArray, getIn } from 'formik'\nimport componentInLibraries from './componentInLibraries'\n\nexport default (props) => {\n  const {\n    item: { type, id, label, forceLabel = false, className = \"\", },\n  } = props\n\n  return <div className={`form-control mb-4 ${className}`}>\n    {\n      (label && forceLabel) &&\n      <label className=\"label\">\n        <span>{label}</span>\n      </label>\n    }\n    <FieldArray\n      type={type}\n      name={id}\n      component={(arrayHelpers) => render({ ...props, arrayHelpers })} />\n    {/* <FieldArray\n      type={type}\n      name={id}\n      render={(arrayHelpers) => render({ ...props, arrayHelpers })} /> */}\n    {/* <FieldArray\n      type={type}\n      name={id}>\n      {(arrayHelpers) => render({ ...props, arrayHelpers })}\n    </FieldArray> */}\n    <ErrorMessage\n      name={id}\n      component=\"div\"\n      className=\"text-sm text-red-600 pt-2\" />\n  </div>\n}\n\n\nconst ErrorMessage = ({ name }) => (\n  <Field\n    name={name}\n    render={({ form }) => {\n      const error = getIn(form.errors, name)\n      const touch = getIn(form.touched, name)\n      return touch && error ? error : null\n    }}\n  />\n)\n\nconst render = (props) => {\n  const {\n    values,\n    item: {\n      id,\n      className = \"\",\n      props: itemProps,\n    },\n    onValuesChanged } = props\n\n  const items = values[id] ? values[id] : []\n  //const [counter, setCounter] = useState(1)\n\n  const { entryFormProvider } = itemProps\n  const Component = componentInLibraries({ componentsLibraries: props.componentsLibraries, item: entryFormProvider })\n  if (!Component) {\n    return null\n  }\n\n  const { arrayHelpers } = props\n  const { move, swap, push, insert, unshift, pop, remove, form } = arrayHelpers\n\n  const onAdd = () => {\n    push(itemProps.placeholder())\n  }\n\n  const customOnValueChanged = (value) => {\n    const { item: { id }, setFieldValue, setFieldTouched } = props\n    // setFieldValue(id, value)\n    // setFieldTouched(id, true, false)\n    //TODO:\n    const _values = { ...props.values }\n    _values[id] = value\n    onValuesChanged && onValuesChanged(_values)\n\n    //setItems(value)\n  }\n\n  return <div>\n    {(items && items.length > 0) && items.map((entry, index) => {\n      const itemId = `${id}.${index}`\n      return <div key={index} className={`form-control mb-4 ${className}`}>\n        {/* {\n        (label && forceLabel) &&\n        <label className=\"label\">\n          <span>{label}</span>\n        </label>\n      } */}\n\n        <Field type={entryFormProvider.type} name={itemId} >\n          {({ field, form }) => {\n            const onRemoveRequired = () => {\n              remove(index)\n              const _i = [...items]\n              _i.splice(index, 1)\n              customOnValueChanged(_i)\n              //setCounter(counter + 1)\n            }\n\n            const onMoveDownRequired = () => {\n              if (items.length <= index) {\n                return\n              }\n              swap(index, index + 1)\n\n              const _i = [...items]\n              const object = _i[index]\n              const other = _i[index + 1]\n              _i[index] = other\n              _i[index + 1] = object\n              customOnValueChanged(_i)\n              //setCounter(counter + 1)\n            }\n\n            const onMoveUpRequired = () => {\n              if (index === 0) {\n                return\n              }\n              swap(index, index - 1)\n\n              const _i = [...items]\n              const object = _i[index]\n              const other = _i[index - 1]\n              _i[index] = other\n              _i[index - 1] = object\n              customOnValueChanged(_i)\n              //setCounter(counter + 1)\n            }\n\n            const onEntryValuesChanged = (value) => {\n              const _i = [...items]\n              _i[index] = value\n              customOnValueChanged(_i)\n            }\n\n            return <Component\n              {...props}\n              value={entry}\n              arrayHelpers={arrayHelpers}\n              onMoveDownRequired={onMoveDownRequired}\n              onMoveUpRequired={onMoveUpRequired}\n              onRemoveRequired={onRemoveRequired}\n              item={entryFormProvider}\n              index={index}\n              canMoveUp={itemProps.canMove && (index > 0)}\n              canMoveDown={itemProps.canMove && (index < (items.length - 1))}\n              canRemove={itemProps.canRemove}\n              showControls={itemProps.showControls}\n              {...itemProps.entryFormProvider.props}\n              customOnValueChanged={onEntryValuesChanged} />\n          }}\n        </Field>\n        <BaseErrorMesssage\n          name={itemId}\n          component=\"div\"\n          className=\"text-sm text-red-600 pt-2\" />\n      </div>\n    })}\n    {(itemProps.canAddItems && items.length < itemProps.maxItems) &&\n      <div className={`flex justify-center my-10`}>\n        {itemProps.addComponent\n          ? itemProps.addComponent({ onClick: onAdd })\n          : <button\n            type=\"button\"\n            onClick={onAdd}>\n            +\n          </button>\n        }</div>}\n  </div>\n}\n","import React, { useCallback } from 'react'\nimport { Field, ErrorMessage, FastField } from 'formik'\nimport componentInLibraries from './componentInLibraries'\nimport { nanoid } from 'nanoid'\n\nexport default (props) => {\n  const { item: { type, id, label, isDependant = false, forceLabel = false, className = \"\" }, onValuesChanged } = props\n  const Component = componentInLibraries({ componentsLibraries: props.componentsLibraries, item: props.item })\n  if (!Component) {\n    return null\n  }\n\n  const _id = id ? id : nanoid()\n  const Renderer = isDependant ? Field : FastField\n\n  return <div className={`form-control mb-4 ${className}`}>\n    {\n      (label && forceLabel) &&\n      <label className=\"label\">\n        <span>{label}</span>\n      </label>\n    }\n\n    <Renderer type={type} name={_id} >\n      {({ field, form }) => {\n\n        const customOnValueChanged = (value) => {\n          console.log('customOnValueChanged', value)\n          if (!props.item.id) {\n            return\n          }\n          const { item: { id }, setFieldValue, setFieldTouched, setValues } = props\n          setFieldValue(id, value, false)\n          setFieldTouched(id, true, false)\n          const _values = { ...props.values }\n          _values[id] = value\n          //setValues(_values, false)\n          onValuesChanged && onValuesChanged(_values)\n        }\n\n        return <Component\n          {...props}\n          value={props.values[id]}\n          field={field}\n          form={form}\n          customOnValueChanged={customOnValueChanged} />\n      }}\n    </Renderer>\n    <ErrorMessage\n      name={_id}\n      component=\"div\"\n      className=\"text-sm text-red-600 pt-2\" />\n  </div>\n}\n","import React, { useEffect } from 'react'\nimport { useFormikContext } from 'formik'\nimport { Form } from 'formik'\nimport FieldArray from './fieldArray'\nimport Field from './field'\n\n\nconst render = () => {\n  const { values } = useFormikContext()\n  useEffect(() => {\n    console.log('-------------------- values', values)\n  }, [values])\n  return generate({ ...formProps, ...props, initialValues, validationSchema, onValuesChanged })\n}\n\nexport const generate = (props) => {\n  const { formItemsProvider } = props\n  const items = Array.isArray(formItemsProvider) ? formItemsProvider : formItemsProvider()\n  return <Form className=\"grid grid-flow-row\">\n    {\n      items.map(item => {\n        const { isMulti } = item\n        if (isMulti) {\n          return _generateItemsView({ ...props, item })\n        }\n\n        return _generateItemView({ ...props, item, })\n      })\n    }\n  </Form>\n}\n\nconst _generateItemsView = (props) => {\n  const { item: { className, items } } = props\n\n  return <div className={className}>\n    {items.map(_item => _generateItemView({ ...props, item: _item, }))}\n  </div>\n}\n\nconst _generateItemView = (props) => {\n  const { item } = props\n  if (item.hide) {\n    return null\n  }\n\n  if (item.isList) {\n    return <FieldArray {...props} />\n  }\n\n  return <Field {...props} />\n}\n","export default class FormulaikCache {\n  _data = {}\n  constructor(props) {\n\n  }\n  get data() { return this._data }\n  set data(value) { this._data = value }\n\n  add = ({ search, results, key }) => {\n    if (!this.data[key]) {\n      this.data[key] = {}\n    }\n    this.data[key][search] = [...results]\n    console.log('Formulaik cache > add >', key, search, results)\n  }\n\n  get = ({ search, key }) => {\n    if (!this.data[key]) {\n      console.log('Formulaik cache > get > key is not present', key)\n      return null\n    }\n\n    console.log('Formulaik cache > get > key is present', key, 'Returning', this.data[key][search])\n    return this.data[key][search]\n  }\n\n  clear = () => {\n    this.data = {}\n  }\n}\n","import React, { useRef } from 'react'\nimport { Formik } from 'formik'\nimport { generate } from './content'\nimport FormulaikCache from './cache'\n\nexport default (props) => {\n  const {\n    onSubmit,\n    error,\n    onFormPropsChanged,\n    enableCache = true\n  } = props\n\n  const initialValues = (typeof props.initialValues !== 'function') ? props.initialValues : (props.initialValues && props.initialValues())\n  const validationSchema = (typeof props.validationSchema !== 'function') ? props.validationSchema : (props.validationSchema && props.validationSchema())\n\n  const cache = useRef(enableCache ? new FormulaikCache() : null)\n  const onValuesChanged = (values) => {\n    props.onValuesChanged && props.onValuesChanged(values)\n    console.log('onValuesChanged hook')\n  }\n\n  return <div>\n    <Formik\n      initialValues={initialValues}\n      validationSchema={validationSchema}\n      onSubmit={onSubmit}>\n      {formProps => {\n        onFormPropsChanged && onFormPropsChanged(formProps)\n        return generate({ ...formProps, ...props, initialValues, validationSchema, onValuesChanged, cache: cache.current })\n      }\n      }\n    </Formik>\n\n    {error &&\n      <div className=\"alert alert-error mb-4\">\n        <div className=\"flex-1\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" className=\"w-6 h-6 mx-2 stroke-current\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636\"></path>\n          </svg>\n          <label>{error.message}</label>\n        </div>\n      </div>}\n  </div>\n}\n"],"names":["props","componentsLibraries","item","i","length","component","type","id","label","forceLabel","className","FieldArray","arrayHelpers","render","ErrorMessage","name","Field","form","error","getIn","errors","touch","touched","values","itemProps","onValuesChanged","items","entryFormProvider","Component","componentInLibraries","swap","push","insert","remove","onAdd","placeholder","customOnValueChanged","value","_values","map","entry","index","itemId","onRemoveRequired","_i","splice","onMoveDownRequired","object","other","onMoveUpRequired","onEntryValuesChanged","canMove","canRemove","showControls","BaseErrorMesssage","canAddItems","maxItems","addComponent","onClick","isDependant","_id","nanoid","Renderer","FastField","field","console","log","setFieldValue","setFieldTouched","generate","formItemsProvider","Array","isArray","isMulti","_generateItemsView","_generateItemView","_item","hide","isList","FormulaikCache","_data","add","search","results","key","data","get","clear","onSubmit","onFormPropsChanged","enableCache","initialValues","validationSchema","cache","useRef","formProps","current","message"],"mappings":"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"}